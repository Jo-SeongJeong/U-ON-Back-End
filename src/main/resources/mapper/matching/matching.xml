<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.uon.matching.model.mapper.MatchingMapper">

    <insert id="insertMatchingRoom" parameterType="activity">
        insert into activity
        (user_id, title, content, activity_address, activity_date, current_participant, max_participant,
        min_participant, deadline, dong_code, is_completed, is_deadline, type, create_time)
        values
        (#{userId}, #{title}, #{content}, #{activityAddress}, #{activityDate}, #{currentParticipant}, #{maxParticipant},
        #{minParticipant}, #{deadline}, #{dongCode}, #{isCompleted}, #{isDeadline}, #{type}, now())
    </insert>

    <update id="updateMatchingRoom" parameterType="activity">
        update activity set activity_address=#{activityAddress}, activity_date=#{activityDate}, title=#{title}, content=#{content},
        create_time=now(), current_participant=#{currentParticipant}, dong_code=#{dongCode}, is_completed=#{isCompleted},
        is_deadline=#{isDeadline}, max_participant=#{maxParticipant}, min_participant=#{minParticipant}, type=#{type}
        where activity_id=#{activityId};
    </update>
    
    <select id="selectAllMatchingRoom" resultType="activity">
        select
        activity_id as activityId, activity_address as activityAddress, activity_date as activityDate, content,
        create_time as createTime, current_participant as currentParticipant, dong_code as dongCode,
        deadline, is_completed as isCompleted, is_deadline as isDeadline, max_participant as maxParticipant,
        min_participant as minParticipant, title, type, user_id as userId
        from activity
    </select>

    <select id="selectMatchingRoomOfType" parameterType="int" resultType="activity">
        select
        activity_id as activityId, activity_address as activityAddress, activity_date as activityDate, content,
        create_time as createTime, current_participant as currentParticipant, dong_code as dongCode,
        deadline, is_completed as isCompleted, is_deadline as isDeadline, max_participant as maxParticipant,
        min_participant as minParticipant, title, type, user_id as userId
        from activity
        where type=#{type}
    </select>

    <select id="selectMatchingRoom" parameterType="int" resultType="activity">
        select
        activity_id as activityId, activity_address as activityAddress, activity_date as activityDate, content,
        create_time as createTime, current_participant as currentParticipant, dong_code as dongCode,
        deadline, is_completed as isCompleted, is_deadline as isDeadline, max_participant as maxParticipant,
        min_participant as minParticipant, title, type, user_id as userId
        from activity
        where activity_id=#{activityId}
    </select>

    <delete id="deleteMatchingRoom" parameterType="int">
        delete from activity
        where activity_id=#{activityId}
    </delete>

    <update id="updateIsDeadline" parameterType="int">
        update activity set
        is_deadline=1
        where activity_id=#{activityId};
    </update>

    <update id="updateIsComplete" parameterType="int">
        update activity set
        is_completed=1
        where activity_id=#{activityId};
    </update>

</mapper>